<html>
<title>PROB5: SHEET</title>
<body>
<h4>PROB5: <font color="blue">SHEET</font>
</h4>
<ul>
       See if a spreadsheet has a consistent formulation.
     </ul>
<h4>DESCRIPTION</h4>
<ul>
  <p>Any given cell of a spreadsheet can have a formula that depends
  on the value from some other cell. Before trying to calculate the
  value of a cell it is important to determine if the definition of
  the formula for that cell is circular.</p>

  <p>Our spreadsheet only has a limited formulation for expressions:
<ul><pre><tt>
definition := cell &quot;=&quot; expression
expression := term | expression &quot;+&quot; term | expression &quot; &quot; term
term := factor | term &quot;*&quot; factor | term &quot;/&quot; factor
factor := number | cell | &quot;(&quot; expression &quot;)&quot;
number := digit | number digit
digit := &quot;0&quot; | &quot;1&quot; | &quot;2&quot; | &quot;3&quot; | &quot;4&quot; | &quot;5&quot; | &quot;6&quot; | &quot;7&quot; | &quot;8&quot; | &quot;9&quot;
cell := &quot;R&quot; digit digit &quot;C&quot; digit digit
</tt></pre></ul>
  Valid cell rows and columns are 1 through 20, so that a total of 400
  cells are available in our spreadsheet.</p>
  </ul>
<h4>
    INPUT: <font color="blue"><tt>prob5.dat</tt></font>
  </h4>
<ul>
    <p>The input file will contain one or more lines, each
    representing cells that are defined in the spreadsheet.</p>

    <p>An example input file would be
<tt><pre>
<font color="red">       column   111111111122222222223</font>
<font color="red">       123456789012345678901234567890</font>
<font color="red">line 1:<font color="black">R01C01=1</font><font size="-2">[EOL]</font></font>
<font color="red">     2:<font color="black">R01C02=2</font><font size="-2">[EOL]</font></font>
<font color="red">     3:<font color="black">R01C03=R01C01+R01C02</font><font size="-2">[EOL]</font></font>
<font color="red">     4:<font color="black">R02C01=(R03C02+1)*R01C03</font><font size="-2">[EOL]</font></font>
<font color="red">     5:<font color="black">R03C02=R02C01</font><font size="-2">[EOL]</font></font>
<font color="red">      :<font size="-2">[EOF]</font></font>
</pre></tt>
    Note that, if a an expression in some cell refers to some other
    cell, the contents of that other cell will always be defined.</p>
  </ul>
<h4>
    OUTPUT: <font color="blue"><tt>prob5.out</tt></font>
</h4>
<ul>
  <p>Other than the standard header and trailer messages, a single
  line is printed for each cell defined in the input file (and in the
  same order).  This should be the cell name followed by &quot;circular&quot; if
  evaluating the cell results in a circular definition (either
  directly or indirectly).  If the cell can be evaluated without a
  circular definition, then the word &quot;ok&quot; should follow the cell.</p>

  <p>The correct output corresponding to the example input file would
 be:
<tt><pre>
<font color="red">       column   111111111122222222223</font>
<font color="red">       123456789012345678901234567890</font>
<font color="red">line 1:<font color="black">Program 5 by team 0</font><font size="-2">[EOL]</font></font>
<font color="red">     2:<font color="black">R01C01 ok</font><font size="-2">[EOL]</font></font>
<font color="red">     3:<font color="black">R01C02 ok</font><font size="-2">[EOL]</font></font>
<font color="red">     4:<font color="black">R01C03 ok</font><font size="-2">[EOL]</font></font>
<font color="red">     5:<font color="black">R02C01 circular</font><font size="-2">[EOL]</font></font>
<font color="red">     6:<font color="black">R03C02 circular</font><font size="-2">[EOL]</font></font>
<font color="red">     7:<font color="black">End of program 5 by team 0</font><font size="-2">[EOL]</font></font>
<font color="red">      :<font size="-2">[EOF]</font></font>
</pre></tt>
</p>
</ul>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <title>Problem E: Problem E: Balance</title>
    <style type="text/css"><!--
      html { margin-left: 4em; }
      h1 { margin-left: -2em; font-size: 14pt; }
      tt,pre { font-weight: bold; font-size: 12pt; }
   --></style>
  </head><body>
    <h1>Problem E: Problem E: Balance</h1>

    <br/><b>Source:</b> <tt>balance.{c,cpp,java}</tt>
    <br/><b>Input:</b> <tt>console {stdin,cin,System.in}</tt>
    <br/><b>Output:</b> <tt>console {stdout,cout,System.out}</tt>

<p>
An investor invests a certain percentage of his assets into
<tt>NINSTRUMENTS</tt> financial instruments. After each term, these
instruments deduct a certain fixed administrative cost, followed by a
fee that is a percentage of the amount that was invested at the
beginning of the term, and then add a return, which is a (positive or
negative) percentage of the amount invested at the beginning of the
term. If any account drops to zero or below after such a transaction,
it is considered closed (no fees are charged against it, and is
treated as simply zero) until a rebalancing occurs.
</p>

<p>
Rebalancing occurs after every <tt>NREBALANCE</tt> terms, where the total assets of the investor are redistributed according to the original ratios for the instruments. Without rebalancing, the investor's assets would become dominated by the higher return instruments, which would expose them to more risk compared to a balanced investment plan. Note that it is possible that all instruments drop to zero, in which case they all remain closed for the remaining terms.
</p>

<p>
You are to model the value of such an investment strategy and report the ending value in each instrument (before rebalancing, if it happens to land on a term when a rebalance is due). Compute your results using double precision (do not round intermediate values to pennies), but round your final answers to pennies.
</p>

<h1>Input</h1>

<p>
The first line of the input contains the three positive integers:
</p>

<pre>
NINSTRUMENTS NTERMS NREBALANCE
</pre>

<p>
There are no more than 10 instruments, and the number of terms is at most 20. This is followed by 3 lines of floating-point numbers separated by spaces, in the following format:
</p>

<pre>
FIXED_FEE(1) .. FIXED_FEE(NINSTRUMENTS)
PERCENTAGE_FEE(1) .. PERCENTAGE_FEE(NINSTRUMENTS)
PRINCIPAL_START(1) .. PRINCIPAL_START(NINSTRUMENTS)
</pre>

<p>
Finally, there are <tt>NTERMS</tt> lines each containing <tt>NINSTRUMENTS</tt> floating-point numbers indicating the percentage return of each instrument in each term:
</p>

<pre>
RETURN(1,1) .. RETURN(1,NINSTRUMENTS)
RETURN(2,1) .. RETURN(2,NINSTRUMENTS)
.
.
RETURN(NTERMS,1) .. RETURN(NTERMS,NINSTRUMENTS)
</pre>

<p>
All percentages (<tt>PERCENTAGE_FEE</tt> and <tt>RETURN</tt>) are given as ratios, up to 4 decimal places. For example, a fee of 0.0002 means 0.02% of the investment in this instrument is deducted as a fee each term. <tt>FIXED_FEE</tt> and <tt>PRINCIPAL_START</tt> are non-negative floating-point numbers that are specified to 2 decimal places. At least one of the <tt>PRINCIPAL_START</tt> values is positive.
</p>

<h1>Output</h1>

<p>
Write on a single line the principal of each investment (separated by a space) at the end of <tt>NTERMS</tt> terms. Round each principal to the nearest penny.
</p>

<pre>
PRINCIPAL_END(1) .. PRINCIPAL_END(NINSTRUMENTS)
</pre>

<h1>Sample Input</h1>

<pre>
4 10 5
5.00 10.00 20.00 50.00
0.002 0.001 0.0008 0.0005
150000.00 100000.00 75000.00 50000.00
0.10 0.05 -0.05 -0.85
0.10 0.05 -0.10 -0.85
0.10 0.05 -0.20 -0.85
0.10 0.05 -0.40 -0.85
0.10 0.05 -0.80 -0.85
0.10 0.05 -0.05 -0.90
0.10 0.05 -0.05 -0.90
0.10 0.05 -0.05 -0.90
0.10 0.05 -0.05 -0.85
0.10 0.05 -0.05 -0.85
</pre>

<h1>Sample Output</h1>

<pre>
237698.69 126086.01 57298.74 0.00
</pre>

</body>
</html>
